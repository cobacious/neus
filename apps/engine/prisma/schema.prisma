generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Article {
  id                 String                     @id @default(cuid())
  url                String                     @unique
  title              String
  snippet            String?
  content            String?
  source             String
  publishedAt        DateTime
  rawHtml            String?
  embedding          Json?
  createdAt          DateTime                   @default(now())
  clusterAssignments ArticleClusterAssignment[]
}

model Cluster {
  id                 String                     @id @default(cuid())
  createdAt          DateTime                   @default(now())
  label              String?
  origin             String
  headline           String?
  summary            String?
  articleAssignments ArticleClusterAssignment[]
}

model ArticleClusterAssignment {
  id         String   @id @default(cuid())
  articleId  String
  clusterId  String
  similarity Float?
  method     String
  createdAt  DateTime @default(now())
  cluster    Cluster  @relation(fields: [clusterId], references: [id])
  article    Article  @relation(fields: [articleId], references: [id])

  @@unique([articleId, clusterId])
}
